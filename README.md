# Тестовое задание для "Омега-консалтинг, ООО"
- В данном проекте реализован импорт данных из предостввленного csv файла в mongodb.
- Уникальность записей реализована состаным индексом по 3 полям.
- Импорт происходит в процедурном режиме и если требуется обработка больших данных, то нужно использовать пакетный способ.
- Реализована индексация данных из mongo в elastic, в пакетном режиме, включая уникальность данных по тем-же полям что и в mongo.
- Mongo / Elastic реализованы на docker
- Для запуска требуется php 8.3 установленная на хосте

## Для запуска проекта:
- git clone https://github.com/StasPetrovSky1988/MongoElasticYii2TestTask.git testtask
- Переходим в корень проекта
- Ставим зависимости: composer install
- Поднимаем docker с mongo + elastic: docker compose up -d
- Миграции: php yii migrate/up
- Сделать импорт из файла: php yii import/invoices-csv (В консоле видно пульс работы скрипта)
- Проиндексировать в elastic: php yii elastic/indexing (В консоле видно пульс работы скрипта)
- Поднимаем хост: php -S localhost:8080 -t web

## Тест функционала
- Пример фильтрации по api через эластик: http://localhost:8080/invoice?product_code=4785003&product_name=стрептоцид&date_invoice_to=2021-10-01&date_invoice_from=2021-09-01
- Пример агрегации по нескольким полям через эластик: http://localhost:8080/report?region=КИЕВСКАЯ
